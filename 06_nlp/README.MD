# 06_nlp — NLP / LLM Projects

Проекты по обработке естественного языка: от классического ML на **TF-IDF** до **BERT** и прикладных пайплайнов на **LLM** (анализ отзывов, кластеризация карточек).

---

## Projects (quick view)

| Проект | Файл | Подход | Метрики |
|---|---|---|---|
| Toxic comments (TF-IDF) | `Классификация токсичных комментариев (TF-IDF).ipynb` | TF-IDF + линейная модель + подбор порога | TEST: **F1 0.8139**, **ROC-AUC 0.9791**, **PR-AUC 0.8970** |
| Toxic comments (BERT) | `Классификация токсичных комментариев (BERT).ipynb` | Transformers/BERT + подбор порога | TEST: **F1 0.8423**, **ROC-AUC 0.9872**, **PR-AUC 0.9269** |
| Reviews NLP analytics (LLM/Qwen) | `NLP-аналитика отзывов - тональность, аспекты и резюме (LLM, Qwen).ipynb` | LLM-пайплайн (тональность/аспекты/summary) | — |
| Product clustering | `Кластеризация товаров продавца (1).ipynb` | Embeddings + UMAP + HDBSCAN/DBSCAN | **Silhouette 0.798**, **Davies–Bouldin 0.299**, **Clusters 7** |

---

## 1) Классификация токсичных комментариев (TF-IDF)

**Файл:** `Классификация токсичных комментариев (TF-IDF).ipynb`  
**Цель:** построить baseline-модель, которая определяет токсичные комментарии.

**Что сделано:**
- очистка и нормализация текста, базовая предобработка;
- векторизация **TF-IDF**;
- обучение и сравнение линейных моделей;
- подбор **порога классификации** под F1;
- оценка качества и анализ матрицы ошибок.

**Модели (baseline):**
- **Logistic Regression** (основная)
- *(если в ноутбуке сравнивалось несколько линейных — оставь это как факт; если нет, можно удалить строку выше и оставить только LogReg)*

**Ключевые метрики (TEST):**
- **F1:** 0.8139  
- **ROC-AUC:** 0.9791  
- **PR-AUC:** 0.8970  

---

## 2) Классификация токсичных комментариев (BERT)

**Файл:** `Классификация токсичных комментариев (BERT).ipynb`  
**Цель:** улучшить качество по сравнению с классическим TF-IDF baseline.

**Что сделано:**
- пайплайн на **Transformers/BERT**;
- получение вероятностей + **подбор оптимального порога** под F1;
- отчёты по метрикам и sanity-checks.

**Ключевые метрики (TEST):**
- **F1:** 0.8423  
- **ROC-AUC:** 0.9872  
- **PR-AUC:** 0.9269  

**Сравнение (BERT − TF-IDF+LogReg) на TEST:**
- **F1:** +0.0284  
- **ROC-AUC:** +0.0081  
- **PR-AUC:** +0.0299  

---

## 3) NLP-аналитика отзывов: тональность, аспекты и резюме (LLM/Qwen)

**Файл:** `NLP-аналитика отзывов - тональность, аспекты и резюме (LLM, Qwen).ipynb`  
**Цель:** построить прикладной NLP-пайплайн для анализа отзывов без ручной разметки.

**Подход:** LLM (Qwen) автоматически размечает каждый отзыв по 3 полям:
- `sentiment`: **positive / neutral / negative**
- `aspect`: **quality / price / delivery / service / other**
- `summary`: короткое резюме (5–15 слов)

**Что в ноутбуке:**
- prompt-разметка отзывов;
- сводные распределения по тональности/аспектам;
- примеры разметки и быстрые срезы по сегментам.

---

## 4) Кластеризация товаров продавца (Embeddings + UMAP + HDBSCAN)

**Файл:** `Кластеризация товаров продавца (1).ipynb`  
**Цель:** сгруппировать карточки товаров по смыслу (для анализа ассортимента/структуры каталога).

**Пайплайн:**
- текстовая подготовка карточек (очистка «маркетплейсного мусора», нормализация);
- эмбеддинги **Sentence-Transformers**
  - модель: `sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2`
- LLM-обогащение коротких карточек
  - модель: `Qwen/Qwen2.5-0.5B-Instruct`
- понижение размерности:
  - **UMAP** (пространство для кластеризации)
  - **t-SNE** (визуализация)
- кластеризация:
  - **HDBSCAN / DBSCAN**
- визуализация кластеров + интерпретация результатов.

**Ключевые метрики (итоговая конфигурация):**
- **Silhouette:** 0.798  
- **Davies–Bouldin:** 0.299 *(ниже — лучше)*  
- **n_clusters:** 7 *(noise share: 0.053, N=75)*

---

## Stack (short)
- **Python**, pandas, numpy, scikit-learn, matplotlib  
- **NLP:** TF-IDF, Transformers/BERT  
- **LLM:** Qwen (prompt-pipeline)  
- **Clustering:** embeddings, UMAP, HDBSCAN/DBSCAN  



## Как запускать

- Для воспроизведения обычно достаточно Python-стека: `pandas`, `numpy`, `scikit-learn`, `matplotlib`.
- Для отдельных ноутбуков дополнительно:
  - `transformers`, `torch` (BERT)
  - `sentence-transformers`, `umap-learn`, `hdbscan` (кластеризация)
  - LLM-части требуют доступной модели/окружения (локально/в облаке).


